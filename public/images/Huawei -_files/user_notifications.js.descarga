(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["/js/main/user_notifications"],{

/***/ "./resources/js/main/user_notifications.js":
/*!*************************************************!*\
  !*** ./resources/js/main/user_notifications.js ***!
  \*************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/// [ GLOBAL VARIABLES ]
var notifications_list = document.getElementById("notifications_list");
var notification_icon = document.getElementById("notification_icon");
var notification_counter = document.getElementById("notification_counter");
var template = document.getElementById("notification_template");
var title = template.querySelector(".notification_title");
var description = template.querySelector(".notification_description");
var actions = template.querySelector(".notification_actions");
var api_read_route = notifications_list.getAttribute("data-route"); // Add listener events to notifications

notifications = notifications_list.querySelectorAll(".notification-item");
notifications.forEach(function (notification) {
  notification.addEventListener("mouseenter", function () {
    if (notification.getAttribute("data-read") == null) {
      notification_id = notification.getAttribute("data-id");
      mark_as_read(notification, notification_id);
    }
  });
}); // Listen for new notifications in real time

if (user_id != null) {
  window.Echo["private"]('users.' + user_id + '.notifications').notification(function (e) {
    // Set notification attributes
    data = e.data; // Copy and paste template to notifications area

    copied_template = template.cloneNode(true);
    new_notification = notifications_list.insertBefore(copied_template, notifications_list.firstChild); // Set title and description

    new_title = new_notification.querySelector(".notification-title");
    new_description = new_notification.querySelector(".notification-description");
    new_title.innerHTML = data.title;
    new_description.innerHTML = data.description; // Add actions

    actions_area = new_notification.querySelector(".notification-actions");
    data.actions.forEach(function (action) {
      if (action.quiet == false) {
        new_action = document.createElement("A");
        new_action.innerHTML = action.name;
        new_action.setAttribute("href", action.url);
        new_action.className = "badge badge-secondary mr-2";
        actions_area.appendChild(new_action);
      }
    }); // Set event listener to set notification as read

    new_notification.addEventListener("mouseenter", function () {
      mark_as_read(new_notification, e.id);
    }); // Make notification appear

    new_notification.setAttribute("id", null);
    new_notification.hidden = false; // Delete extra notification

    if (notifications_list.childElementCount >= 6) {
      last_notification = notifications_list.lastElementChild.previousElementSibling;
      notifications_list.removeChild(last_notification);
    } // Turn on icon and set new unread notification counter


    notification_on();
  });
} /// [ FUNCTIONS ]


function mark_as_read(notification, id) {
  notification.setAttribute("data-read", true);
  route = api_read_route.replace("notification_id", id);
  $.ajaxSetup({
    headers: {
      'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
    }
  });
  $.ajax({
    url: route,
    method: 'post',
    success: function success(result) {
      notification_off(notification);
    }
  });
}

function notification_on() {
  // Add an unit to the counter
  new_number = parseInt(notification_counter.innerHTML) + 1;
  notification_counter.innerHTML = new_number;
  notification_counter.hidden = false; // Turn on notification icon

  notification_icon.classList.add("icon-cuco-darkgray");
  notification_icon.classList.remove("icon-cuco-gray"); // Remove no notifications message

  document.getElementById("see_notifications").hidden = false;
  document.getElementById("no_notifications").hidden = true;
}

function notification_off(notification) {
  title = notification.querySelector(".notification-title");
  title.classList.remove("color-cuco-blue");
  new_number = parseInt(notification_counter.innerHTML) - 1;
  notification_counter.innerHTML = new_number;

  if (new_number <= 0) {
    // Turn off notification icon
    notification_counter.hidden = true;
    notification_icon.classList.remove("icon-cuco-darkgray");
    notification_icon.classList.add("icon-cuco-gray");
  }
}

/***/ }),

/***/ 17:
/*!*******************************************************!*\
  !*** multi ./resources/js/main/user_notifications.js ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(/*! /home/futureed/html/huawei_code/resources/js/main/user_notifications.js */"./resources/js/main/user_notifications.js");


/***/ })

},[[17,"/js/manifest"]]]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9yZXNvdXJjZXMvanMvbWFpbi91c2VyX25vdGlmaWNhdGlvbnMuanMiXSwibmFtZXMiOlsibm90aWZpY2F0aW9uc19saXN0IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsIm5vdGlmaWNhdGlvbl9pY29uIiwibm90aWZpY2F0aW9uX2NvdW50ZXIiLCJ0ZW1wbGF0ZSIsInRpdGxlIiwicXVlcnlTZWxlY3RvciIsImRlc2NyaXB0aW9uIiwiYWN0aW9ucyIsImFwaV9yZWFkX3JvdXRlIiwiZ2V0QXR0cmlidXRlIiwibm90aWZpY2F0aW9ucyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwibm90aWZpY2F0aW9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsIm5vdGlmaWNhdGlvbl9pZCIsIm1hcmtfYXNfcmVhZCIsInVzZXJfaWQiLCJ3aW5kb3ciLCJFY2hvIiwiZSIsImRhdGEiLCJjb3BpZWRfdGVtcGxhdGUiLCJjbG9uZU5vZGUiLCJuZXdfbm90aWZpY2F0aW9uIiwiaW5zZXJ0QmVmb3JlIiwiZmlyc3RDaGlsZCIsIm5ld190aXRsZSIsIm5ld19kZXNjcmlwdGlvbiIsImlubmVySFRNTCIsImFjdGlvbnNfYXJlYSIsImFjdGlvbiIsInF1aWV0IiwibmV3X2FjdGlvbiIsImNyZWF0ZUVsZW1lbnQiLCJuYW1lIiwic2V0QXR0cmlidXRlIiwidXJsIiwiY2xhc3NOYW1lIiwiYXBwZW5kQ2hpbGQiLCJpZCIsImhpZGRlbiIsImNoaWxkRWxlbWVudENvdW50IiwibGFzdF9ub3RpZmljYXRpb24iLCJsYXN0RWxlbWVudENoaWxkIiwicHJldmlvdXNFbGVtZW50U2libGluZyIsInJlbW92ZUNoaWxkIiwibm90aWZpY2F0aW9uX29uIiwicm91dGUiLCJyZXBsYWNlIiwiJCIsImFqYXhTZXR1cCIsImhlYWRlcnMiLCJhdHRyIiwiYWpheCIsIm1ldGhvZCIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJub3RpZmljYXRpb25fb2ZmIiwibmV3X251bWJl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ImZpbGUiOiIvanMvbWFpbi91c2VyX25vdGlmaWNhdGlvbnMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcbi8vLyBbIEdMT0JBTCBWQVJJQUJMRVMgXVxudmFyIG5vdGlmaWNhdGlvbnNfbGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibm90aWZpY2F0aW9uc19saXN0XCIpO1xudmFyIG5vdGlmaWNhdGlvbl9pY29uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJub3RpZmljYXRpb25faWNvblwiKTtcbnZhciBub3RpZmljYXRpb25fY291bnRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibm90aWZpY2F0aW9uX2NvdW50ZXJcIik7XG52YXIgdGVtcGxhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5vdGlmaWNhdGlvbl90ZW1wbGF0ZVwiKTtcbnZhciB0aXRsZSA9IHRlbXBsYXRlLnF1ZXJ5U2VsZWN0b3IoXCIubm90aWZpY2F0aW9uX3RpdGxlXCIpO1xudmFyIGRlc2NyaXB0aW9uID0gdGVtcGxhdGUucXVlcnlTZWxlY3RvcihcIi5ub3RpZmljYXRpb25fZGVzY3JpcHRpb25cIik7XG52YXIgYWN0aW9ucyA9IHRlbXBsYXRlLnF1ZXJ5U2VsZWN0b3IoXCIubm90aWZpY2F0aW9uX2FjdGlvbnNcIik7XG52YXIgYXBpX3JlYWRfcm91dGUgPSBub3RpZmljYXRpb25zX2xpc3QuZ2V0QXR0cmlidXRlKFwiZGF0YS1yb3V0ZVwiKTtcblxuLy8gQWRkIGxpc3RlbmVyIGV2ZW50cyB0byBub3RpZmljYXRpb25zXG5ub3RpZmljYXRpb25zID0gbm90aWZpY2F0aW9uc19saXN0LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubm90aWZpY2F0aW9uLWl0ZW1cIik7XG5ub3RpZmljYXRpb25zLmZvckVhY2goZnVuY3Rpb24obm90aWZpY2F0aW9uKSB7XG4gIG5vdGlmaWNhdGlvbi5hZGRFdmVudExpc3RlbmVyKFwibW91c2VlbnRlclwiLCBmdW5jdGlvbigpIHtcbiAgICBpZihub3RpZmljYXRpb24uZ2V0QXR0cmlidXRlKFwiZGF0YS1yZWFkXCIpID09IG51bGwpIHtcbiAgICAgIG5vdGlmaWNhdGlvbl9pZCA9IG5vdGlmaWNhdGlvbi5nZXRBdHRyaWJ1dGUoXCJkYXRhLWlkXCIpO1xuICAgICAgbWFya19hc19yZWFkKG5vdGlmaWNhdGlvbiwgbm90aWZpY2F0aW9uX2lkKTtcbiAgICB9XG4gIH0pO1xufSk7XG5cbi8vIExpc3RlbiBmb3IgbmV3IG5vdGlmaWNhdGlvbnMgaW4gcmVhbCB0aW1lXG5pZih1c2VyX2lkICE9IG51bGwpIHtcbiAgd2luZG93LkVjaG8ucHJpdmF0ZSgndXNlcnMuJyArIHVzZXJfaWQgKyAnLm5vdGlmaWNhdGlvbnMnKS5ub3RpZmljYXRpb24oZSA9PiB7XG4gICAgLy8gU2V0IG5vdGlmaWNhdGlvbiBhdHRyaWJ1dGVzXG4gICAgZGF0YSA9IGUuZGF0YTtcbiAgICAvLyBDb3B5IGFuZCBwYXN0ZSB0ZW1wbGF0ZSB0byBub3RpZmljYXRpb25zIGFyZWFcbiAgICBjb3BpZWRfdGVtcGxhdGUgPSB0ZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgbmV3X25vdGlmaWNhdGlvbiA9IG5vdGlmaWNhdGlvbnNfbGlzdC5pbnNlcnRCZWZvcmUoY29waWVkX3RlbXBsYXRlLCBub3RpZmljYXRpb25zX2xpc3QuZmlyc3RDaGlsZCk7XG4gICAgLy8gU2V0IHRpdGxlIGFuZCBkZXNjcmlwdGlvblxuICAgIG5ld190aXRsZSA9IG5ld19ub3RpZmljYXRpb24ucXVlcnlTZWxlY3RvcihcIi5ub3RpZmljYXRpb24tdGl0bGVcIik7XG4gICAgbmV3X2Rlc2NyaXB0aW9uID0gbmV3X25vdGlmaWNhdGlvbi5xdWVyeVNlbGVjdG9yKFwiLm5vdGlmaWNhdGlvbi1kZXNjcmlwdGlvblwiKTtcbiAgICBuZXdfdGl0bGUuaW5uZXJIVE1MID0gZGF0YS50aXRsZTtcbiAgICBuZXdfZGVzY3JpcHRpb24uaW5uZXJIVE1MID0gZGF0YS5kZXNjcmlwdGlvbjtcbiAgICAvLyBBZGQgYWN0aW9uc1xuICAgIGFjdGlvbnNfYXJlYSA9IG5ld19ub3RpZmljYXRpb24ucXVlcnlTZWxlY3RvcihcIi5ub3RpZmljYXRpb24tYWN0aW9uc1wiKTtcbiAgICBkYXRhLmFjdGlvbnMuZm9yRWFjaChmdW5jdGlvbihhY3Rpb24pIHtcbiAgICAgIGlmKGFjdGlvbi5xdWlldCA9PSBmYWxzZSkge1xuICAgICAgICBuZXdfYWN0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIkFcIik7XG4gICAgICAgIG5ld19hY3Rpb24uaW5uZXJIVE1MID0gYWN0aW9uLm5hbWU7XG4gICAgICAgIG5ld19hY3Rpb24uc2V0QXR0cmlidXRlKFwiaHJlZlwiLCBhY3Rpb24udXJsKTtcbiAgICAgICAgbmV3X2FjdGlvbi5jbGFzc05hbWUgPSBcImJhZGdlIGJhZGdlLXNlY29uZGFyeSBtci0yXCI7XG4gICAgICAgIGFjdGlvbnNfYXJlYS5hcHBlbmRDaGlsZChuZXdfYWN0aW9uKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICAvLyBTZXQgZXZlbnQgbGlzdGVuZXIgdG8gc2V0IG5vdGlmaWNhdGlvbiBhcyByZWFkXG4gICAgbmV3X25vdGlmaWNhdGlvbi5hZGRFdmVudExpc3RlbmVyKFwibW91c2VlbnRlclwiLCBmdW5jdGlvbigpIHtcbiAgICAgIG1hcmtfYXNfcmVhZChuZXdfbm90aWZpY2F0aW9uLCBlLmlkKTtcbiAgICB9KTtcbiAgICAvLyBNYWtlIG5vdGlmaWNhdGlvbiBhcHBlYXJcbiAgICBuZXdfbm90aWZpY2F0aW9uLnNldEF0dHJpYnV0ZShcImlkXCIsIG51bGwpO1xuICAgIG5ld19ub3RpZmljYXRpb24uaGlkZGVuID0gZmFsc2U7XG4gICAgLy8gRGVsZXRlIGV4dHJhIG5vdGlmaWNhdGlvblxuICAgIGlmKG5vdGlmaWNhdGlvbnNfbGlzdC5jaGlsZEVsZW1lbnRDb3VudCA+PSA2KSB7XG4gICAgICBsYXN0X25vdGlmaWNhdGlvbiA9IG5vdGlmaWNhdGlvbnNfbGlzdC5sYXN0RWxlbWVudENoaWxkLnByZXZpb3VzRWxlbWVudFNpYmxpbmc7XG4gICAgICBub3RpZmljYXRpb25zX2xpc3QucmVtb3ZlQ2hpbGQobGFzdF9ub3RpZmljYXRpb24pO1xuICAgIH1cbiAgICAvLyBUdXJuIG9uIGljb24gYW5kIHNldCBuZXcgdW5yZWFkIG5vdGlmaWNhdGlvbiBjb3VudGVyXG4gICAgbm90aWZpY2F0aW9uX29uKCk7XG4gIH0pO1xufVxuXG4vLy8gWyBGVU5DVElPTlMgXVxuZnVuY3Rpb24gbWFya19hc19yZWFkKG5vdGlmaWNhdGlvbiwgaWQpIHtcbiAgbm90aWZpY2F0aW9uLnNldEF0dHJpYnV0ZShcImRhdGEtcmVhZFwiLCB0cnVlKTtcbiAgcm91dGUgPSBhcGlfcmVhZF9yb3V0ZS5yZXBsYWNlKFwibm90aWZpY2F0aW9uX2lkXCIsIGlkKTtcbiAgJC5hamF4U2V0dXAoe1xuICAgIGhlYWRlcnM6IHtcbiAgICAgICdYLUNTUkYtVE9LRU4nOiAkKCdtZXRhW25hbWU9XCJjc3JmLXRva2VuXCJdJykuYXR0cignY29udGVudCcpXG4gICAgfVxuICB9KTtcbiAgJC5hamF4KHtcbiAgICB1cmw6IHJvdXRlLFxuICAgIG1ldGhvZDogJ3Bvc3QnLFxuICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3VsdCl7XG4gICAgICBub3RpZmljYXRpb25fb2ZmKG5vdGlmaWNhdGlvbik7XG4gICAgfVxuICB9KTtcbn1cblxuZnVuY3Rpb24gbm90aWZpY2F0aW9uX29uKCkge1xuICAvLyBBZGQgYW4gdW5pdCB0byB0aGUgY291bnRlclxuICBuZXdfbnVtYmVyID0gcGFyc2VJbnQobm90aWZpY2F0aW9uX2NvdW50ZXIuaW5uZXJIVE1MKSArIDE7XG4gIG5vdGlmaWNhdGlvbl9jb3VudGVyLmlubmVySFRNTCA9IG5ld19udW1iZXI7XG4gIG5vdGlmaWNhdGlvbl9jb3VudGVyLmhpZGRlbiA9IGZhbHNlO1xuICAvLyBUdXJuIG9uIG5vdGlmaWNhdGlvbiBpY29uXG4gIG5vdGlmaWNhdGlvbl9pY29uLmNsYXNzTGlzdC5hZGQoXCJpY29uLWN1Y28tZGFya2dyYXlcIik7XG4gIG5vdGlmaWNhdGlvbl9pY29uLmNsYXNzTGlzdC5yZW1vdmUoXCJpY29uLWN1Y28tZ3JheVwiKTtcbiAgLy8gUmVtb3ZlIG5vIG5vdGlmaWNhdGlvbnMgbWVzc2FnZVxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNlZV9ub3RpZmljYXRpb25zXCIpLmhpZGRlbiA9IGZhbHNlO1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5vX25vdGlmaWNhdGlvbnNcIikuaGlkZGVuID0gdHJ1ZTtcbn1cblxuZnVuY3Rpb24gbm90aWZpY2F0aW9uX29mZihub3RpZmljYXRpb24pIHtcbiAgdGl0bGUgPSBub3RpZmljYXRpb24ucXVlcnlTZWxlY3RvcihcIi5ub3RpZmljYXRpb24tdGl0bGVcIik7XG4gIHRpdGxlLmNsYXNzTGlzdC5yZW1vdmUoXCJjb2xvci1jdWNvLWJsdWVcIik7XG4gIG5ld19udW1iZXIgPSBwYXJzZUludChub3RpZmljYXRpb25fY291bnRlci5pbm5lckhUTUwpIC0gMTtcbiAgbm90aWZpY2F0aW9uX2NvdW50ZXIuaW5uZXJIVE1MID0gbmV3X251bWJlcjtcbiAgaWYobmV3X251bWJlciA8PSAwKSB7XG4gICAgLy8gVHVybiBvZmYgbm90aWZpY2F0aW9uIGljb25cbiAgICBub3RpZmljYXRpb25fY291bnRlci5oaWRkZW4gPSB0cnVlO1xuICAgIG5vdGlmaWNhdGlvbl9pY29uLmNsYXNzTGlzdC5yZW1vdmUoXCJpY29uLWN1Y28tZGFya2dyYXlcIik7XG4gICAgbm90aWZpY2F0aW9uX2ljb24uY2xhc3NMaXN0LmFkZChcImljb24tY3Vjby1ncmF5XCIpO1xuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9