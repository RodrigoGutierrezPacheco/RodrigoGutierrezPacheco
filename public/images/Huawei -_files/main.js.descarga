(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["/js/comments/main"],{

/***/ "./node_modules/webpack/buildin/global.js":
/*!***********************************!*\
  !*** (webpack)/buildin/global.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports) {

var g;

// This works in non-strict mode
g = (function() {
	return this;
})();

try {
	// This works if eval is allowed (see CSP)
	g = g || new Function("return this")();
} catch (e) {
	// This works if the window reference is available
	if (typeof window === "object") g = window;
}

// g can still be undefined, but nothing to do about it...
// We return undefined, instead of nothing here, so it's
// easier to handle this case. if(!global) { ...}

module.exports = g;


/***/ }),

/***/ "./node_modules/webpack/buildin/module.js":
/*!***********************************!*\
  !*** (webpack)/buildin/module.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = function(module) {
	if (!module.webpackPolyfill) {
		module.deprecate = function() {};
		module.paths = [];
		// module.parent = undefined by default
		if (!module.children) module.children = [];
		Object.defineProperty(module, "loaded", {
			enumerable: true,
			get: function() {
				return module.l;
			}
		});
		Object.defineProperty(module, "id", {
			enumerable: true,
			get: function() {
				return module.i;
			}
		});
		module.webpackPolyfill = 1;
	}
	return module;
};


/***/ }),

/***/ "./resources/js/comments/main.js":
/*!***************************************!*\
  !*** ./resources/js/comments/main.js ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var _require = __webpack_require__(/*! lodash */ "./node_modules/lodash/lodash.js"),
    filter = _require.filter; // Global variables


var content_id = "content_comments"; // Get elements

var form_element = document.getElementById("form-comment");
var btn_submit = document.getElementById("btn_submit");
var comment = document.getElementById("comment");
var content = document.getElementById(content_id); /// [ MAIN EVENT ]

window.onload = function () {
  reload_forms();
  reload_textareas();
  load_comments();
};

function reload_forms() {
  $('.form-comment').off('submit');
  $('.form-comment').on('submit', function (e) {
    // Disable button and submit
    e.preventDefault();
    disable_textareas();
    e.target.querySelector("button").disabled = true; // Submit data

    form_element = document.querySelector(".form-comment");
    form_url = form_element.getAttribute("action");
    $.ajax({
      url: form_url,
      type: 'post',
      // data: $("#form-comment").serialize(),
      data: $(e.target).serialize(),
      dataType: 'json',
      success: function success(_response) {
        comment.value = "";
        load_comments();
      },
      error: function error(_response) {
        console.log(_response);
      }
    });
  });
}

function reload_textareas() {
  $(".form-comment").on("input", function (e) {
    root = findAncestor(e.target, ".form-comment");
    text_area = root.querySelector("textarea");
    btn = root.querySelector("button");
    letters_limit = root.querySelector("span.letters");
    length_min = text_area.getAttribute("data-min");
    length_max = text_area.getAttribute("data-limit");
    length = text_area.value.length;
    letters_limit.innerHTML = length_max - length;

    if (length >= length_min && length <= length_max) {
      btn.disabled = false;
    } else {
      btn.disabled = true;
    }
  });
  $("textarea.comment, textarea.comment-comment").on("keypress", function (e) {
    text_area = e.target;
    length_max = text_area.getAttribute("data-limit");

    if (text_area.value.length >= length_max) {
      return false;
    }
  });
}

function disable_textareas() {
  $(".form-comment").off("input");
}

function ajaxLoad(filename, content) {
  var filters = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};
  content = typeof content !== 'undefined' ? content : 'content';
  $('.loading').show();
  $.ajax({
    type: "GET",
    url: filename,
    data: filters,
    contentType: false,
    success: function success(data) {
      $("#" + content).html(data);
      $('.loading').hide();
      pagination_control();
      reload_forms();
      reload_textareas();
      set_extra_comments();
    },
    error: function error(xhr, status, _error) {
      console.log(xhr);
      console.log(_error);
    }
  });
}

function pagination_control() {
  // Look for pagination items
  $('.page-item').click(function (e) {
    e.preventDefault();
    route = e.target.href;

    if (route) {
      ajaxLoad(route, content_id);
    }
  });
}

function load_comments() {
  route = content.getAttribute('data-route');
  filters = {};
  filters_raw = content.getAttribute('data-filters');

  if (filters_raw != null || filters_raw != "") {
    filters = JSON.parse(filters_raw);
  }

  ajaxLoad(route, content_id, filters);
}

function set_extra_comments() {
  // Find add comments buttons
  comments_add = document.querySelectorAll(".comment_add");
  comments_add.forEach(function (comment_add) {
    comment_add.addEventListener("click", function () {
      hide_all_comment_sections();
      root = findAncestor(comment_add, ".row");
      comment_section = root.querySelector(".comment_section");
      comment_section.hidden = false;
    });
  });
}

function hide_all_comment_sections() {
  document.querySelectorAll(".comment_section").forEach(function (el) {
    el.hidden = true;
  });
}

function findAncestor(el, sel) {
  while ((el = el.parentElement) && !(el.matches || el.matchesSelector).call(el, sel)) {
    ;
  }

  return el;
}

/***/ }),

/***/ 28:
/*!*********************************************!*\
  !*** multi ./resources/js/comments/main.js ***!
  \*********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(/*! /home/futureed/html/huawei_code/resources/js/comments/main.js */"./resources/js/comments/main.js");


/***/ })

},[[28,"/js/manifest","/js/vendor"]]]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vKHdlYnBhY2spL2J1aWxkaW4vZ2xvYmFsLmpzIiwid2VicGFjazovLy8od2VicGFjaykvYnVpbGRpbi9tb2R1bGUuanMiLCJ3ZWJwYWNrOi8vLy4vcmVzb3VyY2VzL2pzL2NvbW1lbnRzL21haW4uanMiXSwibmFtZXMiOlsicmVxdWlyZSIsImZpbHRlciIsImNvbnRlbnRfaWQiLCJmb3JtX2VsZW1lbnQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiYnRuX3N1Ym1pdCIsImNvbW1lbnQiLCJjb250ZW50Iiwid2luZG93Iiwib25sb2FkIiwicmVsb2FkX2Zvcm1zIiwicmVsb2FkX3RleHRhcmVhcyIsImxvYWRfY29tbWVudHMiLCIkIiwib2ZmIiwib24iLCJlIiwicHJldmVudERlZmF1bHQiLCJkaXNhYmxlX3RleHRhcmVhcyIsInRhcmdldCIsInF1ZXJ5U2VsZWN0b3IiLCJkaXNhYmxlZCIsImZvcm1fdXJsIiwiZ2V0QXR0cmlidXRlIiwiYWpheCIsInVybCIsInR5cGUiLCJkYXRhIiwic2VyaWFsaXplIiwiZGF0YVR5cGUiLCJzdWNjZXNzIiwiX3Jlc3BvbnNlIiwidmFsdWUiLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJyb290IiwiZmluZEFuY2VzdG9yIiwidGV4dF9hcmVhIiwiYnRuIiwibGV0dGVyc19saW1pdCIsImxlbmd0aF9taW4iLCJsZW5ndGhfbWF4IiwibGVuZ3RoIiwiaW5uZXJIVE1MIiwiYWpheExvYWQiLCJmaWxlbmFtZSIsImZpbHRlcnMiLCJzaG93IiwiY29udGVudFR5cGUiLCJodG1sIiwiaGlkZSIsInBhZ2luYXRpb25fY29udHJvbCIsInNldF9leHRyYV9jb21tZW50cyIsInhociIsInN0YXR1cyIsImNsaWNrIiwicm91dGUiLCJocmVmIiwiZmlsdGVyc19yYXciLCJKU09OIiwicGFyc2UiLCJjb21tZW50c19hZGQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImNvbW1lbnRfYWRkIiwiYWRkRXZlbnRMaXN0ZW5lciIsImhpZGVfYWxsX2NvbW1lbnRfc2VjdGlvbnMiLCJjb21tZW50X3NlY3Rpb24iLCJoaWRkZW4iLCJlbCIsInNlbCIsInBhcmVudEVsZW1lbnQiLCJtYXRjaGVzIiwibWF0Y2hlc1NlbGVjdG9yIiwiY2FsbCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSw0Q0FBNEM7O0FBRTVDOzs7Ozs7Ozs7Ozs7QUNuQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7ZUNyQm1CQSxtQkFBTyxDQUFDLCtDQUFELEM7SUFBbEJDLE0sWUFBQUEsTSxFQUVSOzs7QUFDQSxJQUFJQyxVQUFVLEdBQUcsa0JBQWpCLEMsQ0FFQTs7QUFDQSxJQUFJQyxZQUFZLEdBQUdDLFFBQVEsQ0FBQ0MsY0FBVCxDQUF3QixjQUF4QixDQUFuQjtBQUNBLElBQUlDLFVBQVUsR0FBR0YsUUFBUSxDQUFDQyxjQUFULENBQXdCLFlBQXhCLENBQWpCO0FBQ0EsSUFBSUUsT0FBTyxHQUFHSCxRQUFRLENBQUNDLGNBQVQsQ0FBd0IsU0FBeEIsQ0FBZDtBQUNBLElBQUlHLE9BQU8sR0FBR0osUUFBUSxDQUFDQyxjQUFULENBQXdCSCxVQUF4QixDQUFkLEMsQ0FFQTs7QUFDQU8sTUFBTSxDQUFDQyxNQUFQLEdBQWdCLFlBQVc7QUFDekJDLGNBQVk7QUFDWkMsa0JBQWdCO0FBQ2hCQyxlQUFhO0FBQ2QsQ0FKRDs7QUFNQSxTQUFTRixZQUFULEdBQXdCO0FBQ3RCRyxHQUFDLENBQUMsZUFBRCxDQUFELENBQW1CQyxHQUFuQixDQUF1QixRQUF2QjtBQUNBRCxHQUFDLENBQUMsZUFBRCxDQUFELENB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aWxlIjoiL2pzL2NvbW1lbnRzL21haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZztcblxuLy8gVGhpcyB3b3JrcyBpbiBub24tc3RyaWN0IG1vZGVcbmcgPSAoZnVuY3Rpb24oKSB7XG5cdHJldHVybiB0aGlzO1xufSkoKTtcblxudHJ5IHtcblx0Ly8gVGhpcyB3b3JrcyBpZiBldmFsIGlzIGFsbG93ZWQgKHNlZSBDU1ApXG5cdGcgPSBnIHx8IG5ldyBGdW5jdGlvbihcInJldHVybiB0aGlzXCIpKCk7XG59IGNhdGNoIChlKSB7XG5cdC8vIFRoaXMgd29ya3MgaWYgdGhlIHdpbmRvdyByZWZlcmVuY2UgaXMgYXZhaWxhYmxlXG5cdGlmICh0eXBlb2Ygd2luZG93ID09PSBcIm9iamVjdFwiKSBnID0gd2luZG93O1xufVxuXG4vLyBnIGNhbiBzdGlsbCBiZSB1bmRlZmluZWQsIGJ1dCBub3RoaW5nIHRvIGRvIGFib3V0IGl0Li4uXG4vLyBXZSByZXR1cm4gdW5kZWZpbmVkLCBpbnN0ZWFkIG9mIG5vdGhpbmcgaGVyZSwgc28gaXQnc1xuLy8gZWFzaWVyIHRvIGhhbmRsZSB0aGlzIGNhc2UuIGlmKCFnbG9iYWwpIHsgLi4ufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGc7XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuXHRpZiAoIW1vZHVsZS53ZWJwYWNrUG9seWZpbGwpIHtcblx0XHRtb2R1bGUuZGVwcmVjYXRlID0gZnVuY3Rpb24oKSB7fTtcblx0XHRtb2R1bGUucGF0aHMgPSBbXTtcblx0XHQvLyBtb2R1bGUucGFyZW50ID0gdW5kZWZpbmVkIGJ5IGRlZmF1bHRcblx0XHRpZiAoIW1vZHVsZS5jaGlsZHJlbikgbW9kdWxlLmNoaWxkcmVuID0gW107XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG1vZHVsZSwgXCJsb2FkZWRcIiwge1xuXHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiBtb2R1bGUubDtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobW9kdWxlLCBcImlkXCIsIHtcblx0XHRcdGVudW1lcmFibGU6IHRydWUsXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gbW9kdWxlLmk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0bW9kdWxlLndlYnBhY2tQb2x5ZmlsbCA9IDE7XG5cdH1cblx0cmV0dXJuIG1vZHVsZTtcbn07XG4iLCJjb25zdCB7IGZpbHRlciB9ID0gcmVxdWlyZShcImxvZGFzaFwiKTtcblxuLy8gR2xvYmFsIHZhcmlhYmxlc1xudmFyIGNvbnRlbnRfaWQgPSBcImNvbnRlbnRfY29tbWVudHNcIjtcblxuLy8gR2V0IGVsZW1lbnRzXG52YXIgZm9ybV9lbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJmb3JtLWNvbW1lbnRcIik7XG52YXIgYnRuX3N1Ym1pdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYnRuX3N1Ym1pdFwiKTtcbnZhciBjb21tZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb21tZW50XCIpO1xudmFyIGNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb250ZW50X2lkKTtcblxuLy8vIFsgTUFJTiBFVkVOVCBdXG53aW5kb3cub25sb2FkID0gZnVuY3Rpb24oKSB7XG4gIHJlbG9hZF9mb3JtcygpO1xuICByZWxvYWRfdGV4dGFyZWFzKCk7XG4gIGxvYWRfY29tbWVudHMoKTtcbn1cblxuZnVuY3Rpb24gcmVsb2FkX2Zvcm1zKCkge1xuICAkKCcuZm9ybS1jb21tZW50Jykub2ZmKCdzdWJtaXQnKTtcbiAgJCgnLmZvcm0tY29tbWVudCcpLm9uKCdzdWJtaXQnLCBmdW5jdGlvbihlKXtcbiAgICAvLyBEaXNhYmxlIGJ1dHRvbiBhbmQgc3VibWl0XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGRpc2FibGVfdGV4dGFyZWFzKCk7XG4gICAgZS50YXJnZXQucXVlcnlTZWxlY3RvcihcImJ1dHRvblwiKS5kaXNhYmxlZCA9IHRydWU7XG4gICAgLy8gU3VibWl0IGRhdGFcbiAgICBmb3JtX2VsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm0tY29tbWVudFwiKTtcbiAgICBmb3JtX3VybCA9IGZvcm1fZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJhY3Rpb25cIik7XG4gICAgJC5hamF4KHtcbiAgICAgIHVybDogZm9ybV91cmwsXG4gICAgICB0eXBlOiAncG9zdCcsXG4gICAgICAvLyBkYXRhOiAkKFwiI2Zvcm0tY29tbWVudFwiKS5zZXJpYWxpemUoKSxcbiAgICAgIGRhdGE6ICQoZS50YXJnZXQpLnNlcmlhbGl6ZSgpLFxuICAgICAgZGF0YVR5cGU6ICdqc29uJyxcbiAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKCBfcmVzcG9uc2UgKSB7XG4gICAgICAgIGNvbW1lbnQudmFsdWUgPSBcIlwiO1xuICAgICAgICBsb2FkX2NvbW1lbnRzKCk7XG4gICAgICB9LFxuICAgICAgZXJyb3I6IGZ1bmN0aW9uKCBfcmVzcG9uc2UgKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKF9yZXNwb25zZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiByZWxvYWRfdGV4dGFyZWFzKCkge1xuICAkKFwiLmZvcm0tY29tbWVudFwiKS5vbihcImlucHV0XCIsIGZ1bmN0aW9uKGUpIHtcbiAgICByb290ID0gZmluZEFuY2VzdG9yKGUudGFyZ2V0LCBcIi5mb3JtLWNvbW1lbnRcIik7XG4gICAgdGV4dF9hcmVhID0gcm9vdC5xdWVyeVNlbGVjdG9yKFwidGV4dGFyZWFcIik7XG4gICAgYnRuID0gcm9vdC5xdWVyeVNlbGVjdG9yKFwiYnV0dG9uXCIpO1xuICAgIGxldHRlcnNfbGltaXQgPSByb290LnF1ZXJ5U2VsZWN0b3IoXCJzcGFuLmxldHRlcnNcIik7XG4gICAgbGVuZ3RoX21pbiA9IHRleHRfYXJlYS5nZXRBdHRyaWJ1dGUoXCJkYXRhLW1pblwiKTtcbiAgICBsZW5ndGhfbWF4ID0gdGV4dF9hcmVhLmdldEF0dHJpYnV0ZShcImRhdGEtbGltaXRcIik7XG4gICAgbGVuZ3RoID0gdGV4dF9hcmVhLnZhbHVlLmxlbmd0aDtcbiAgICBsZXR0ZXJzX2xpbWl0LmlubmVySFRNTCA9IGxlbmd0aF9tYXggLSBsZW5ndGg7XG4gICAgaWYobGVuZ3RoID49IGxlbmd0aF9taW4gJiYgbGVuZ3RoIDw9IGxlbmd0aF9tYXgpIHtcbiAgICAgIGJ0bi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICBidG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgIH1cbiAgfSk7XG4gICQoXCJ0ZXh0YXJlYS5jb21tZW50LCB0ZXh0YXJlYS5jb21tZW50LWNvbW1lbnRcIikub24oXCJrZXlwcmVzc1wiLCBmdW5jdGlvbihlKSB7XG4gICAgdGV4dF9hcmVhID0gZS50YXJnZXQ7XG4gICAgbGVuZ3RoX21heCA9IHRleHRfYXJlYS5nZXRBdHRyaWJ1dGUoXCJkYXRhLWxpbWl0XCIpO1xuICAgIGlmKHRleHRfYXJlYS52YWx1ZS5sZW5ndGggPj0gbGVuZ3RoX21heCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGRpc2FibGVfdGV4dGFyZWFzKCkge1xuICAkKFwiLmZvcm0tY29tbWVudFwiKS5vZmYoXCJpbnB1dFwiKTtcbn1cblxuZnVuY3Rpb24gYWpheExvYWQoZmlsZW5hbWUsIGNvbnRlbnQsIGZpbHRlcnM9e30pIHtcbiAgY29udGVudCA9IHR5cGVvZiBjb250ZW50ICE9PSAndW5kZWZpbmVkJyA/IGNvbnRlbnQgOiAnY29udGVudCc7XG4gICQoJy5sb2FkaW5nJykuc2hvdygpO1xuICAkLmFqYXgoe1xuICAgIHR5cGU6IFwiR0VUXCIsXG4gICAgdXJsOiBmaWxlbmFtZSxcblx0XHRkYXRhOiBmaWx0ZXJzLFxuICAgIGNvbnRlbnRUeXBlOiBmYWxzZSxcbiAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgJChcIiNcIiArIGNvbnRlbnQpLmh0bWwoZGF0YSk7XG4gICAgICAkKCcubG9hZGluZycpLmhpZGUoKTtcbiAgICAgIHBhZ2luYXRpb25fY29udHJvbCgpO1xuICAgICAgcmVsb2FkX2Zvcm1zKCk7XG4gICAgICByZWxvYWRfdGV4dGFyZWFzKCk7XG4gICAgICBzZXRfZXh0cmFfY29tbWVudHMoKTtcbiAgICB9LFxuICAgIGVycm9yOiBmdW5jdGlvbiAoeGhyLCBzdGF0dXMsIGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyh4aHIpO1xuXHRcdFx0Y29uc29sZS5sb2coZXJyb3IpO1xuICAgIH1cbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHBhZ2luYXRpb25fY29udHJvbCgpIHtcbiAgLy8gTG9vayBmb3IgcGFnaW5hdGlvbiBpdGVtc1xuICAkKCcucGFnZS1pdGVtJykuY2xpY2soZnVuY3Rpb24oZSl7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHJvdXRlID0gZS50YXJnZXQuaHJlZjtcbiAgICBpZihyb3V0ZSkge1xuICAgICAgYWpheExvYWQocm91dGUsIGNvbnRlbnRfaWQpO1xuICAgIH1cbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGxvYWRfY29tbWVudHMoKSB7XG4gIHJvdXRlID0gY29udGVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtcm91dGUnKTtcblx0ZmlsdGVycyA9IHt9O1xuXHRmaWx0ZXJzX3JhdyA9IGNvbnRlbnQuZ2V0QXR0cmlidXRlKCdkYXRhLWZpbHRlcnMnKTtcblx0aWYoZmlsdGVyc19yYXcgIT0gbnVsbCB8fCBmaWx0ZXJzX3JhdyAhPSBcIlwiKSB7XG5cdFx0ZmlsdGVycyA9IEpTT04ucGFyc2UoZmlsdGVyc19yYXcpO1xuXHR9XG4gIGFqYXhMb2FkKHJvdXRlLCBjb250ZW50X2lkLCBmaWx0ZXJzKTtcbn1cblxuZnVuY3Rpb24gc2V0X2V4dHJhX2NvbW1lbnRzKCkge1xuICAvLyBGaW5kIGFkZCBjb21tZW50cyBidXR0b25zXG4gIGNvbW1lbnRzX2FkZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY29tbWVudF9hZGRcIik7XG4gIGNvbW1lbnRzX2FkZC5mb3JFYWNoKGZ1bmN0aW9uKGNvbW1lbnRfYWRkKSB7XG4gICAgY29tbWVudF9hZGQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgaGlkZV9hbGxfY29tbWVudF9zZWN0aW9ucygpO1xuICAgICAgcm9vdCA9IGZpbmRBbmNlc3Rvcihjb21tZW50X2FkZCwgXCIucm93XCIpO1xuICAgICAgY29tbWVudF9zZWN0aW9uID0gcm9vdC5xdWVyeVNlbGVjdG9yKFwiLmNvbW1lbnRfc2VjdGlvblwiKTtcbiAgICAgIGNvbW1lbnRfc2VjdGlvbi5oaWRkZW4gPSBmYWxzZTtcbiAgICB9KTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGhpZGVfYWxsX2NvbW1lbnRfc2VjdGlvbnMoKSB7XG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY29tbWVudF9zZWN0aW9uXCIpLmZvckVhY2goZnVuY3Rpb24oZWwpIHtcbiAgICBlbC5oaWRkZW4gPSB0cnVlO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gZmluZEFuY2VzdG9yIChlbCwgc2VsKSB7XG4gIHdoaWxlICgoZWwgPSBlbC5wYXJlbnRFbGVtZW50KSAmJiAhKChlbC5tYXRjaGVzIHx8IGVsLm1hdGNoZXNTZWxlY3RvcikuY2FsbChlbCxzZWwpKSk7XG4gIHJldHVybiBlbDtcbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=